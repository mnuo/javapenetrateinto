<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml">  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
<title>无标题文档</title>  

</head>  
  
<body>  

<div>
    <input type="button"  value="自由画笔" onclick="drawPen()"/>
    <input type="button"  value="修改背景图片" onclick="changePictures()"/>
    <div>
        选择画笔颜色： <input id="color" class="color" style="width: 60px;" width="10px" value="66ff00" onchange="changePenColor()">
    </div>
    <div>
        选择画笔宽度： 
        <select id="penWidth" >
            <option>2</option>
            <option>4</option>
            <option>6</option>
            <option>8</option>
        </select>
    </div>
		<!-- <div style="background:url(./script/88.jpg);width: 801px;height: 400px;background-size:cover;}"></div>
        --> <canvas id="can" width="800" height="400" style="border:1px solid #999;position:absolute;top:70px;" >您的浏览器不支持canvas画图功能，推荐使用Google浏览器!</canvas>
		
		<div id="aaa"></div>
</div>
<script type="text/javascript"  src="./script/jquery-1.7.2.min.js"></script>
<script type="text/javascript"  src="./script/jcanvas.js"></script>
<script type="text/javascript"  src="./script/jcanvas-ext.js"></script>
<script type="text/javascript"  src="./script/jscolor.js"></script>
<script type="text/javascript">
function drawPen(){
    var color= "#"+$("#color").val();
    var width=$("#penWidth option:selected").text();
    CanvasExt.drawRect("can",color,width);
}

function changePictures(){
	convertImageToCanvas();
}
function convertImageToCanvas() {
	var image = new Image();
	//image.setAttribute('crossOrigin', 'anonymous');
	image.src="script/88.jpg?time="+new Date().getTime();
	var canvas = document.getElementById("can");
	
	var canContext = canvas.getContext("2d");
	image.onload = function(){
		canContext.strokeStyle="#f90";  //边框颜色
		canContext.linewidth=1;  //边框宽
		image.width = 800;
		image.height = 400;
		//image.crossOrigin = "*";
		canContext.drawImage(image, 0, 0, canvas.width, canvas.height);
		canContext.strokeRect(10,20,100,100); 
		var image1 = new Image();
		
		var image1 = canvas.toDataURL("image/png");
		$("#aaa").append(image1);
		
	}
	
}
</script> 
</body>  
</html>  